webpackJsonp([3],{"6+aJ":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("qG1x"),n=i("TIfe"),s={name:"mainP",components:{footerOh:o.a},data:function(){return{dialogVisible:!1,isLogin:!1,slogan:"",ossUrl:"https://snkae-1301702299.cos.ap-nanjing.myqcloud.com/",baseUrl:"http://47.97.192.85:5207/api/",count:0,queryForm:{page:0,pageSize:10},loginForm:{userName:"",password:""},rules:{userName:[{required:!0,trigger:"blur",message:"username"}],password:[{validator:function(t,e,i){""===e?i(new Error("password")):((e.length<6||e.length>16)&&i(new Error("长度至少6位,不超过16位")),i())},required:!0,trigger:"blur"}]},data:[]}},created:function(){var t=this;"822017161"===Object(n.b)()&&(this.isLogin=!0),this.query(),this.slogan=Object(n.a)(),void 0===this.slogan&&this.axios.get(this.baseUrl+"slogan").then(function(e){t.slogan=e.data.slogan,Object(n.d)(t.slogan)})},methods:{checkAuto:function(t){var e=t.content,i=e.indexOf("song/"),o=e.indexOf("/?userid");return-1!=o&&-1!=i?(t.autoId=e.substring(i+5,o),e.substring(i+5,o)):null},toAdmin:function(){this.$router.push({path:this.redirect||"/admin"})},login:function(){var t=this;this.$refs.loginForm.validate(function(e){e&&t.axios.post(t.baseUrl+"login",t.loginForm).then(function(e){200===e.data.code?(t.isLogin=!0,Object(n.e)(e.data.token),t.dialogVisible=!1,t.$router.push({path:t.redirect||"/admin"})):t.$message({type:"error",message:"密码或用户名错误"})})})},query:function(){var t=this;this.axios.post(this.baseUrl+"query",this.queryForm).then(function(e){t.count=e.data.count,e.data.data.forEach(function(e){t.data.push(e)})})},scroll:function(){var t=this,e=!1;window.onscroll=function(){var i=document.documentElement.offsetHeight-document.documentElement.scrollTop-window.innerHeight<=10;i||(e=!1),i&&!e&&(e=!0,t.queryForm.page+=1,t.data.length+3<t.count&&t.query())}}},mounted:function(){this.scroll()}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"div_main"},[i("el-row",[t.isLogin?i("el-button",{staticStyle:{float:"right"},attrs:{type:"text",icon:"el-icon-right"},on:{click:t.toAdmin}},[t._v("admin")]):i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"text"},on:{click:function(e){t.dialogVisible=!0}}},[i("i",{staticClass:"el-icon-s-promotion"}),t._v("\n      login")])],1),t._v(" "),i("h1",[t._v(t._s(t.slogan))]),t._v(" "),i("el-divider",[i("i",{staticClass:"el-icon-ship"})]),t._v(" "),i("el-timeline",[t._l(t.data,function(e,o){return i("el-timeline-item",{key:o,attrs:{color:"#67C23A",size:"large",type:"succuss",timestamp:e.contentDate,placement:"top"}},[null==t.checkAuto(e)?i("el-card",[i("p",{staticClass:"content"},[t._v(t._s(e.content))]),t._v(" "),e.pic?i("img",{staticStyle:{width:"100%",height:"95%"},attrs:{src:t.ossUrl+e.pic,fit:"cover"}}):t._e()]):i("iframe",{attrs:{frameborder:"no",border:"0",marginwidth:"0",marginheight:"0",height:"86",src:"//music.163.com/outchain/player?type=2&id="+e.autoId+"&auto=0&height=66"}})],1)}),t._v(" "),i("el-timeline-item",{attrs:{color:"#67C23A",size:"large",type:"succuss",timestamp:(new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString(),placement:"top"}}),t._v(" "),i("p",[t._v("End")])],2),t._v(" "),i("footerOh"),t._v(" "),i("el-dialog",{attrs:{title:"login",visible:t.dialogVisible,width:"90%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{ref:"loginForm",attrs:{rules:t.rules,model:t.loginForm,"label-width":"20px;"}},[i("el-form-item",{attrs:{prop:"userName",label:"用户名"}},[i("el-input",{attrs:{placeholder:"输入用户名",clearable:""},model:{value:t.loginForm.userName,callback:function(e){t.$set(t.loginForm,"userName",e)},expression:"loginForm.userName"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"password",label:"密码"}},[i("el-input",{attrs:{type:"password",placeholder:"填写密码",clearable:"","show-password":!0},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login()}},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1),t._v(" "),i("el-form-item",[i("el-button",{staticStyle:{float:"right"},attrs:{size:"small",type:"success",round:""},on:{click:function(e){return t.login()}}},[i("i",{staticClass:"el-icon-s-promotion"}),t._v(" login")])],1)],1)],1)],1)},staticRenderFns:[]};var r=i("VU/8")(s,a,!1,function(t){i("CsyS")},"data-v-392ba67b",null);e.default=r.exports},CsyS:function(t,e){}});
//# sourceMappingURL=3.479c8af5bbb3a7170862.js.map